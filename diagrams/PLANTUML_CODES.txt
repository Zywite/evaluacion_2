===============================================================================
DIAGRAMAS PLANTUML - SISTEMA DE GESTIÃ“N DE RESTAURANTE
===============================================================================

Esta es una compilaciÃ³n de todos los cÃ³digos PlantUML en un solo archivo
para fÃ¡cil acceso y copia. Usa estos cÃ³digos directamente en:
- https://www.plantuml.com/plantuml/uml/
- VS Code con extensiÃ³n PlantUML
- Cualquier herramienta que soporte PlantUML

===============================================================================
1. DIAGRAMA DE CLASES - VERSIÃ“N SIMPLE
===============================================================================

@startuml
skinparam classAttributeIconSize 0
skinparam style strictuml
skinparam class {
    ArrowColor #2196F3
    BorderColor #2196F3
    BackgroundColor #ECEFF1
}
skinparam note {
    BorderColor #2196F3
    BackgroundColor #E3F2FD
}

interface IMenu {
  +nombre: str
  +precio: float
  +esta_disponible(stock: Stock): bool
}

class CrearMenu {
  +CrearMenu(nombre, ingredientes, precio)
  +nombre: str
  +precio: float
  +ingredientes: List[Ingrediente]
}

class Ingrediente {
  +Ingrediente(nombre, cantidad, unidad)
  +nombre: str
  +cantidad: float
  +unidad: str
}

class Stock {
  +Stock()
  +lista_ingredientes: Dict[str, Ingrediente]
  +agregar_ingrediente(ing: Ingrediente)
  +reservar_ingredientes(ings: List[Ingrediente])
}

class Pedido {
  +Pedido()
  +menus: Dict[str, CrearMenu]
  +agregar_menu(menu: CrearMenu)
  +calcular_total(): float
}

class BoletaFacade {
  +BoletaFacade(pedido: Pedido)
  +generar_boleta(): string
}

class Restaurante {
  +Restaurante()
  -stock: Stock
  -pedido: Pedido
  +generar_boleta()
}

Restaurante "1" *-- "1" Stock
Restaurante "1" *-- "1" Pedido
Restaurante ..> BoletaFacade : "usa"
BoletaFacade ..> Pedido : "usa para generar"
Pedido "1" o-- "*" CrearMenu
Stock "1" o-- "*" Ingrediente
CrearMenu "1" *-- "*" Ingrediente
CrearMenu ..|> IMenu

note right of Restaurante
  Clase principal que coordina
  las interacciones del sistema.
end note

note bottom of BoletaFacade
  Implementa el patrÃ³n Facade
  para simplificar generaciÃ³n de PDFs.
end note

@enduml

===============================================================================
2. DIAGRAMA ENTIDAD-RELACIÃ“N (MER) - BASE DE DATOS
===============================================================================

@startuml
skinparam linetype ortho
skinparam backgroundColor #FEFEFE

entity "Clientes" as Clientes {
    *id : int PK
    --
    nombre : string(100)
    apellido : string(100)
    email : string(191) UNIQUE
}

entity "Pedidos" as Pedidos {
    *id : int PK
    --
    cliente_id : int FK
    fecha : datetime DEFAULT(now)
    estado : string(50) DEFAULT('pendiente')
    tipo_entrega : string(50)
    total : decimal(10,2)
}

entity "PedidoItems" as PedidoItems {
    *id : int PK
    --
    pedido_id : int FK
    menu_id : int FK
    cantidad : int
    precio_unitario : decimal(10,2)
    subtotal : decimal(10,2)
}

entity "Menus" as Menus {
    *id : int PK
    --
    nombre : string(191) UNIQUE
    precio : decimal(10,2)
    icono_path : string(255) NULLABLE
}

entity "Ingredientes" as Ingredientes {
    *id : int PK
    --
    nombre : string(191) UNIQUE
    unidad : string(50)
    cantidad : decimal(10,2)
}

entity "MenuIngredientes" as MenuIngredientes {
    *menu_id : int PK, FK
    *ingrediente_id : int PK, FK
    --
    cantidad_necesaria : decimal(10,2)
}

Clientes ||--o{ Pedidos : "realiza"
Pedidos ||--o{ PedidoItems : "contiene"
Menus ||--o{ PedidoItems : "aparece en"
Menus ||--o{ MenuIngredientes : "requiere"
MenuIngredientes }o--|| Ingredientes : "necesita"

note right
    PK = Primary Key
    FK = Foreign Key
    
    ||--o{ : 1 a Muchos
    }o--|| : Muchos a 1
end note

@enduml

===============================================================================
3. DIAGRAMA DE COMPONENTES - ARQUITECTURA
===============================================================================

@startuml ComponentDiagram
skinparam componentStyle uml2
skinparam backgroundColor #FEFEFE

package "PresentaciÃ³n" {
    component [AplicacionConPestanas\nGUI Principal] as GUI
    component [StatisticsTab\nTab de EstadÃ­sticas] as Stats
}

package "LÃ³gica de Negocio" {
    component [Stock\nGestiÃ³n de Inventario] as Stock
    component [Pedido\nGestiÃ³n de Ã“rdenes] as Pedido
    component [BoletaFacade\nGeneraciÃ³n de PDFs] as Facade
    component [MenuCatalog\nFactory de MenÃºs] as Factory
}

package "Persistencia" {
    component [Database\nSQLAlchemy ORM] as DB
    database "restaurante.db\nSQLite" as SQLite
}

package "Servicios Transversales" {
    component [error_handler\nLogging & ValidaciÃ³n] as ErrorHandler
    component [cache_manager\nCachÃ© TTL] as Cache
    component [utilities\nFunciones auxiliares] as Utils
}

GUI --> Stock : "consulta"
GUI --> Pedido : "administra"
GUI --> Facade : "genera boletas"
GUI --> Factory : "obtiene menÃºs"
GUI --> Stats : "visualiza"
Stats --> Cache : "almacena"

Stock --> DB : "persiste"
Pedido --> DB : "persiste"
Facade --> Utils : "formatea"
Facade --> Cache : "cachea"

DB --> SQLite : "lee/escribe"

GUI --> ErrorHandler : "valida"
Stock --> ErrorHandler : "registra"
Cache --> ErrorHandler : "monitorea"

@enduml

===============================================================================
4. DIAGRAMA DE SECUENCIA - FLUJO DE GENERACIÃ“N DE BOLETA
===============================================================================

@startuml SequenceDiagram
actor Usuario
participant "Restaurante\nGUI" as GUI
participant "Stock" as Stock
participant "Pedido" as Pedido
participant "BoletaFacade" as Facade
participant "error_handler" as ErrorH
participant "utilities" as Utils
database "PDF\nFile" as PDF

Usuario -> GUI : Click en "Generar Boleta"
activate GUI

GUI -> Pedido : calcular_total()
activate Pedido
Pedido --> GUI : total
deactivate Pedido

alt Sin errores
    GUI -> Stock : verificar_disponibilidad()
    activate Stock
    Stock --> GUI : disponible=true
    deactivate Stock
    
    GUI -> Facade : generar_boleta()
    activate Facade
    
    Facade -> Utils : formatear_precio(total)
    activate Utils
    Utils --> Facade : "$12.345,67"
    deactivate Utils
    
    Facade -> Utils : calcular_total_con_iva()
    activate Utils
    Utils --> Facade : 14679.57
    deactivate Utils
    
    Facade -> PDF : output(boleta.pdf)
    activate PDF
    PDF --> Facade : ruta
    deactivate PDF
    
    Facade --> GUI : "Boleta generada"
    deactivate Facade
    
    GUI -> ErrorH : logger.info("Boleta creada")
    activate ErrorH
    ErrorH --> GUI : OK
    deactivate ErrorH
    
    GUI --> Usuario : Mostrar vista previa
    
else Con errores
    GUI -> ErrorH : manejo_errores()
    activate ErrorH
    ErrorH --> GUI : excepciÃ³n
    deactivate ErrorH
    GUI --> Usuario : Mostrar error
end

deactivate GUI

@enduml

===============================================================================
5. DIAGRAMA DE ESTADO - CICLO DE VIDA DE UN PEDIDO
===============================================================================

@startuml StateDiagram
[*] --> VacÃ­o : Crear Pedido

VacÃ­o --> ConItems : Agregar MenÃº
VacÃ­o --> [*] : Cancelar

ConItems --> ConItems : Agregar MenÃº
ConItems --> VacÃ­o : Eliminar MenÃº
ConItems --> RevisiÃ³n : Revisar Total

RevisiÃ³n --> ConItems : Modificar
RevisiÃ³n --> Generando : Generar Boleta

Generando --> BBoletaGenerada : Ã‰xito
Generando --> ConItems : Error

BBoletaGenerada --> Guardado : Guardar en BD
Guardado --> [*] : Completado

ConItems --> [*] : Cancelar
RevisiÃ³n --> [*] : Cancelar

@enduml

===============================================================================
6. DIAGRAMA DE DESPLIEGUE
===============================================================================

@startuml DeploymentDiagram
artifact "CÃ³digo Fuente" as Source
artifact "Requirements.txt" as Req

node "PC Usuario" {
    component "Python 3.13" as Python
    component "CustomTkinter GUI" as GUI
    component "MÃ³dulos del Sistema" as Modules
}

node "Base de Datos" {
    database "SQLite\nrestaurante.db" as DB
}

node "Almacenamiento" {
    folder "Boletas" as Boletas
    folder "Cartas PDF" as Cartas
    folder "Logs" as Logs
}

Source --> Python : instala
Req --> Python : especifica

Python --> GUI : carga
Python --> Modules : carga
Modules --> DB : conecta
Modules --> Boletas : genera
Modules --> Cartas : genera
Modules --> Logs : escribe

GUI --> Modules : llama

@enduml

===============================================================================
6. DIAGRAMA DE CLASES - TEMPLATE METHOD (NUEVO)
===============================================================================

@startuml TemplateMethodDiagram
skinparam classAttributeIconSize 0
skinparam style strictuml
skinparam backgroundColor #FEFEFE

' Template Method - Validadores
abstract class ValidadorTemplate {
    #validar(valor: str) -> bool <<template>>
    --
    +{abstract} _validar_especifico(valor: str) -> bool
    #_preparar_datos(valor: str) -> str
    #_registrar_validacion(valor: str, resultado: bool)
}

note bottom of ValidadorTemplate
  Template Method:
  Define flujo comÃºn de validaciÃ³n
  Subclases implementan lo especÃ­fico
end note

class ValidadorCantidad extends ValidadorTemplate {
    +_validar_especifico(valor: str) -> bool
}

class ValidadorPrecio extends ValidadorTemplate {
    +_validar_especifico(valor: str) -> bool
}

class ValidadorNombre extends ValidadorTemplate {
    #_preparar_datos(valor: str) -> str
    +_validar_especifico(valor: str) -> bool
}

class ValidadorEmail extends ValidadorTemplate {
    +_validar_especifico(valor: str) -> bool
}

' Template Method - Generadores de Reportes
abstract class GeneradorReportesTemplate {
    +generar_reporte(parametros: Dict) -> Dict <<template>>
    --
    +{abstract} _obtener_datos(parametros: Dict) -> List
    +{abstract} _procesar_datos(datos: List, parametros: Dict) -> List
    +{abstract} _formatear_reporte(datos: List, parametros: Dict) -> Dict
    #_guardar_reporte(reporte: Dict, parametros: Dict) -> str
}

note bottom of GeneradorReportesTemplate
  Template Method:
  Define flujo comÃºn de generaciÃ³n
  Cada reporte implementa pasos especÃ­ficos
end note

class ReportePedidosDiarios extends GeneradorReportesTemplate {
    +_obtener_datos(parametros: Dict) -> List
    +_procesar_datos(datos: List, parametros: Dict) -> List
    +_formatear_reporte(datos: List, parametros: Dict) -> Dict
}

class ReporteProductosPopulares extends GeneradorReportesTemplate {
    +_obtener_datos(parametros: Dict) -> List
    +_procesar_datos(datos: List, parametros: Dict) -> List
    +_formatear_reporte(datos: List, parametros: Dict) -> Dict
}

class ReporteClientesLeales extends GeneradorReportesTemplate {
    +_obtener_datos(parametros: Dict) -> List
    +_procesar_datos(datos: List, parametros: Dict) -> List
    +_formatear_reporte(datos: List, parametros: Dict) -> Dict
}

legend right
    LÃ­nea punteada y <<template>> = Template Method
    extends = ImplementaciÃ³n concreta
    <<abstract>> = MÃ©todo abstracto (debe implementarse)
endlegend

@enduml

===============================================================================
INSTRUCCIONES DE USO
===============================================================================

1. Elige el diagrama que necesitas (1-6 arriba)
2. Copia TODO el cÃ³digo entre @startuml y @enduml
3. PÃ©galo en una de estas herramientas:
   - https://www.plantuml.com/plantuml/uml/
   - ExtensiÃ³n PlantUML en VS Code
   - AplicaciÃ³n de escritorio PlantUML

4. Para generar archivos:
   - CLI: plantuml -Tsvg archivo.puml
   - Online: Haz clic en Download

RECOMENDACIONES:
- SVG es mejor para web y documentaciÃ³n
- PNG es mejor para presentaciones
- PDF es mejor para impresiÃ³n

===============================================================================
REFERENCIAS DE SÃMBOLOS PlantUML
===============================================================================

RELACIONES:
  * -- : ComposiciÃ³n (relaciÃ³n fuerte)
  o -- : AgregaciÃ³n (relaciÃ³n dÃ©bil)
  --> : AsociaciÃ³n
  ..> : Dependencia
  ..|> : ImplementaciÃ³n

CARDINALIDAD:
  1 : Exactamente uno
  * : Cero o muchos
  1..* : Uno a muchos
  0..1 : Cero a uno

ELEMENTOS:
  class : Clase
  interface : Interfaz
  entity : Entidad de BD
  component : Componente
  package : Paquete/MÃ³dulo
  database : Base de datos
  artifact : Artefacto
  node : Nodo de despliegue

ATRIBUTOS:
  {static} : Miembro estÃ¡tico
  {abstract} : Miembro abstracto
  + : PÃºblico
  - : Privado
  # : Protegido
  ~ : Paquete

===============================================================================
NOTA IMPORTANTE - ACTUALIZACIÃ“N DE VALIDADORES
===============================================================================

A partir de la Ãºltima actualizaciÃ³n (Noviembre 2025):

âœ… CAMBIO: Los validadores Template Method se han integrado en error_handler.py

ANTES:
  - Validadores definidos en template_method.py
  - Referencia en diagramas de clases

AHORA:
  - ValidadorTemplate, ValidadorCantidad, ValidadorPrecio, ValidadorNombre, 
    ValidadorEmail estÃ¡n en error_handler.py
  - template_method.py mantiene GeneradorReportesTemplate y sus implementaciones
  - Diagrama de clases refleja validadores en paquete "Patrones de DiseÃ±o"
  - Paquete "Manejo de Errores" ahora solo contiene LoggerConfig y excepciones

UBICACIONES:
  ğŸ“ error_handler.py
     â”œâ”€â”€ ValidadorTemplate (ABC)
     â”œâ”€â”€ ValidadorCantidad
     â”œâ”€â”€ ValidadorPrecio
     â”œâ”€â”€ ValidadorNombre
     â”œâ”€â”€ ValidadorEmail
     â””â”€â”€ LoggerConfig

  ğŸ“ template_method.py (referencia)
     â”œâ”€â”€ GeneradorReportesTemplate (ABC)
     â”œâ”€â”€ ReportePedidosDiarios
     â”œâ”€â”€ ReporteProductosPopulares
     â””â”€â”€ ReporteClientesLeales

===============================================================================
